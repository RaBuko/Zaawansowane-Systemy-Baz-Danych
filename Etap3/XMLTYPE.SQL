-- FLUSH 
ALTER SYSTEM FLUSH buffer_cache;
ALTER SYSTEM FLUSH shared_pool;

VARIABLE  START_TIME_XMLTYPE NUMBER;
EXEC :START_TIME_XMLTYPE := EXTRACT(SECOND FROM SYSTIMESTAMP);
-- START MIERZENIA CZASU

SELECT CST.CUSTOMERNUMBER, CST.CITY, OFC.details.extract('//office/city/text()').getstringval() AS OFFICE_CITY FROM CUSTOMERS CST
INNER JOIN EMPLOYEES EMP ON CST.SALESREPEMPLOYEENUMBER = EMP.EMPLOYEENUMBER
INNER JOIN OFFICES OFC ON EMP.OFFICECODE = OFC.OFFICECODE
WHERE CST.CITY = OFC.details.extract('//office/city/text()').getstringval(); 

VARIABLE  TIME_FOR_XMLTYPE NUMBER;
EXEC :TIME_FOR_XMLTYPE := EXTRACT(SECOND FROM SYSTIMESTAMP)-:START_TIME_XMLTYPE;
spool etap3_E2_XMLTYPE_results.txt append;
PRINT TIME_FOR_XMLTYPE;
spool off;